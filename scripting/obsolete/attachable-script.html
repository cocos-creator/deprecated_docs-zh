<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>Behavior</title>
    <link type="text/css" rel="stylesheet" href="../../assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="../../assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="../../assets/css/hljs-github.min.css"/>
    <link type="text/css" rel="stylesheet" href="../../assets/css/style.css"/>
    <link rel="shortcut icon" type="image/ico" href="../../assets/favicon.ico">
  </head>
  <body>
  <div class="full-wrap">
    <div class="sidebar markdown-body">
      <div class="inner">
        <div class="logo">
          <a href="../../index.html"><img src="../../assets/img/logo.png"></a>
        </div>
        <ul class="nav nav-list">
          <li class="sidebar-header-1 "><h3><a href="../../getting-started/index.html">Cocos Creator 入门</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/introduction.html">关于 Cocos Creator</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/install.html">安装和启动</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/dashboard.html">使用 Dashboard</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/hello-world.html">Hello World!</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/quick-start.html">快速上手: 制作第一个游戏</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/cocos2d-x-guide.html">Cocos2d-x 用户上手指南</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/unity-guide.html">Unity 用户上手指南</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/project-structure.html">项目结构</a></li>
          <li class=" sidebar-header-3"><a href="../../getting-started/support.html">获取帮助和支持</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../basics/index.html">编辑器基础</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../basics/editor-overview.html">编辑器界面介绍</a></li>
          <li class=" sidebar-header-4"><a href="../../basics/editor-panels/assets.html">资源管理器</a></li>
          <li class=" sidebar-header-4"><a href="../../basics/editor-panels/scene.html">场景编辑器</a></li>
          <li class=" sidebar-header-4"><a href="../../basics/editor-panels/hierarchy.html">层级管理器</a></li>
          <li class=" sidebar-header-4"><a href="../../basics/editor-panels/inspector.html">属性检查器</a></li>
          <li class=" sidebar-header-4"><a href="../../basics/editor-panels/console.html">控制台</a></li>
          <li class=" sidebar-header-3"><a href="../../basics/toolbar.html">工具栏</a></li>
          <li class=" sidebar-header-3"><a href="../../basics/layout.html">编辑器布局</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../asset-workflow/index.html">资源工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/scene-managing.html">创建和管理场景</a></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/sprite.html">图像资源（Texture）</a></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/atlas.html">图集资源（Atlas）</a></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/font.html">字体资源</a></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/particle.html">粒子资源</a></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/audio-asset.html">声音资源（AudioClip）</a></li>
          <li class=" sidebar-header-3"><a href="../../asset-workflow/prefab.html">预制资源（Prefab）</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../content-workflow/index.html">内容创作工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../content-workflow/node-component.html">节点和组件</a></li>
          <li class=" sidebar-header-3"><a href="../../content-workflow/transform.html">坐标系和变换</a></li>
          <li class=" sidebar-header-3"><a href="../../content-workflow/node-tree.html">管理节点层级和显示顺序</a></li>
          <li class=" sidebar-header-3"><a href="../../content-workflow/scene-editing.html">使用场景编辑器搭建场景图像</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../ui/index.html">UI 系统</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../ui/sliced-sprite.html">使用 Sliced Sprite 制作 UI 图像</a></li>
          <li class=" sidebar-header-3"><a href="../../ui/multi-resolution.html">多分辨率适配方案</a></li>
          <li class=" sidebar-header-3"><a href="../../ui/widget-align.html">对齐策略</a></li>
          <li class=" sidebar-header-3"><a href="../../ui/label-layout.html">文字排版</a></li>
          <li class=" sidebar-header-3"><a href="../../ui/ui-components.html">常用 UI 控件</a></li>
          <li class=" sidebar-header-3"><a href="../../ui/auto-layout.html">自动布局容器</a></li>
          <li class=" sidebar-header-3"><a href="../../ui/list-with-data.html">制作动态生成内容的列表</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../animation/index.html">动画系统</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../animation/animation.html">关于 Animation</a></li>
          <li class=" sidebar-header-3"><a href="../../animation/animation-clip.html">创建 Animation 组件和动画剪辑</a></li>
          <li class=" sidebar-header-3"><a href="../../animation/animation-curve.html">编辑动画曲线</a></li>
          <li class=" sidebar-header-3"><a href="../../animation/sprite-animation.html">编辑序列帧动画</a></li>
          <li class=" sidebar-header-3"><a href="../../animation/time-curve.html">编辑时间曲线</a></li>
          <li class=" sidebar-header-3"><a href="../../animation/animation-event.html">添加动画事件</a></li>
          <li class=" sidebar-header-3"><a href="../../animation/scripting-animation.html">使用脚本控制动画</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../components/index.html">组件参考</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../components/sprite.html">Sprite 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/label.html">Label 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/animation.html">Animation 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/canvas.html">Canvas 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/widget.html">Widget 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/progress.html">ProgressBar 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/button.html">Button 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/mask.html">Mask 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/scrollview.html">ScrollView 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/scrollbar.html">ScrollBar 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../../components/layout.html">Layout 组件参考</a></li>
          <li class="sidebar-header-1 "><h3><a href="../index.html">脚本开发工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../use-component.html">创建和使用组件脚本</a></li>
          <li class=" sidebar-header-3"><a href="../properties.html">声明属性</a></li>
          <li class=" sidebar-header-3"><a href="../access-node-component.html">访问节点和其他组件</a></li>
          <li class=" sidebar-header-3"><a href="../life-cycle-callbacks.html">生命周期回调</a></li>
          <li class=" sidebar-header-3"><a href="../create-destroy.html">创建和销毁节点</a></li>
          <li class=" sidebar-header-3"><a href="../events.html">发射和监听事件</a></li>
          <li class=" sidebar-header-3"><a href="../internal-events.html">系统内置事件</a></li>
          <li class=" sidebar-header-3"><a href="../actions.html">使用动作系统</a></li>
          <li class=" sidebar-header-3"><a href="../action-list.html">动作列表</a></li>
          <li class=" sidebar-header-3"><a href="../scheduler.html">使用计时器</a></li>
          <li class=" sidebar-header-3"><a href="../execution-order.html">脚本执行顺序</a></li>
          <li class=" sidebar-header-3"><a href="../pooling.html">使用对象池</a></li>
          <li class=" sidebar-header-3"><a href="../load-assets.html">获取资源</a></li>
          <li class=" sidebar-header-3"><a href="../modular-script.html">模块化脚本</a></li>
          <li class=" sidebar-header-3"><a href="../web-debug-scripts.html">在浏览器中调试脚本</a></li>
          <li class=" sidebar-header-3"><a href="../javascript-primer.html">JavaScript 快速入门</a></li>
          <li class=" sidebar-header-4"><a href="../reference/attributes.html">属性参数参考</a></li>
          <li class="sidebar-header-1 "><h3><a href="../../publish/index.html">跨平台发布游戏</a></h3></li>
          <li class=" sidebar-header-3"><a href="../../publish/publish-web.html">发布到 Web 平台</a></li>
          <li class=" sidebar-header-3"><a href="../../publish/cocos-framework.html">安装配置 Cocos Framework</a></li>
          <li class=" sidebar-header-3"><a href="../../publish/publish-native.html">打包发布原生平台</a></li>
        </ul>
      </div>
    </div>
    <div class="main">
      <article class="markdown-body"><p>What&#39;s the point of a scene editor if we can&#39;t attach scripts to scene nodes and give them behaviors that we can combine and tweak in Inspector? Cocos Creator&#39;s great advantage is to allow you write script that can be attached to scene nodes, while you can still call any engine API from the script! Let&#39;s work it out.</p>
<h2 id="behavior-attachable-script-">Behavior (Attachable Script)</h2>
<p>An attachable script must contain definition of a <code>Behavior</code>. The filename of the script is the class name. For example a script named <code>MyClass.js</code> creates a <code>Behavior</code> named <code>MyClass</code>.</p>
<p>(screenshot)</p>
<p>Once the script is attached to a node, the class name will be used for identifying this modular script in Inspector.</p>
<p>(screenshot)</p>
<p>The whole process is similar to how you write component script for an entity-component system but behind the scene they are quite different.</p>
<p>Behavior is one of the most usual <strong>FireClass</strong>. For details and advanced usage of FireClass, please refer to the <a href="/manual/scripting/class">FireClass</a>.</p>
<h3 id="shared-instance-of-behavior">Shared Instance of Behavior</h3>
<p>Cocos Creator use mixin to combine all scripts attached to a single node together. Thus for all of the scripts that attached to the same node, their instance (<code>this</code>) point to the same node.</p>
<p>Compare to other entity-component system, Cocos Creator don&#39;t have &#39;component&#39; instance and &#39;entity&#39; instance. There is only the node instance, with all properties and method available from scripts attached to the node.</p>
<p>To learn more about how script mixin works in Cocos Creator, see <a href="./mixin-mechanic.html">Mixin Mechanics</a>.</p>
<h2 id="basic-structure-of-an-attachable-script">Basic Structure of an Attachable Script</h2>
<p>Create a script file that follow this pattern:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> MyClass = cc.Class({ <span class="hljs-comment">// use cc.Class to define your class</span>
    extends: cc.Behavior, <span class="hljs-comment">// must have, every FireClass inherit from cc.Behavior</span>
    properties: {
        <span class="hljs-comment">// properties that you want to serialize and exposed in Inspector</span>
    },
    statics: {
        <span class="hljs-comment">// you can export variables and functions declared outside of FireClass prototype object in this script</span>
    },
    onLoad: {
        <span class="hljs-comment">// initialization code</span>
    }
});</code></pre><p>The name <code>MyClass</code> in the script is not relevant, only the <strong>filename of the script</strong> is used for identifying this FireClass. Thus it&#39;s not allowed to create scripts with the same name in a single project.</p>
<p>As long as your script contains a Behavior definition, it can be dragged and attached onto a node. Let&#39;s keep going to see how to add property and function to your script.</p>
<h2 id="add-properties">Add Properties</h2>
<p>To allow values/variables in your script to be edited from the Inspector, you must add them as <code>properties</code> in your script.</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> MyClass = cc.Class({ <span class="hljs-comment">// use cc.Class to define your class</span>
    extends: cc.Behavior,
    properties: {
        myNumber: <span class="hljs-number">0</span>,
        myNode: {
            <span class="hljs-keyword">default</span>: <span class="hljs-literal">null</span>,
            wrapper: cc.Node
        }
    }
});</code></pre><p>In the above example, we defined two properties with different format.</p>
<ul class="list">
<li>If your property is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Primitive_values">primitive value</a>, just write the default value that follows colon.</li>
<li>If your property is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Objects">object</a>, you need to explicitly define its default value and type. In the type field you can also write class defined with game engine API.</li>
</ul>
<p>Once this is done, your properties will be serialized and shown in Inspector. From here on you can edit them in Inspector, no need for changing the code if you just want value or reference to be updated.</p>
<p>In your script, you can access your properties with <code>this.myNumber</code>, <code>this.myNode</code>. For detailed script access information, read the next chapter <a href="">Access Scripts</a>.</p>
<h2 id="add-functions">Add Functions</h2>
<p>To add a function:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> MyClass = cc.Class({ <span class="hljs-comment">// use cc.Class to define your class</span>
    extends: cc.Behavior,
    properties: {
        <span class="hljs-comment">// some properties</span>
    },
    myFunction: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        cc.log(<span class="hljs-string">'hellow world!'</span>);
    }
});</code></pre><p>Similar to properties, call a function in script with <code>this.myFunction()</code>.</p>
<h2 id="initialization">Initialization</h2>
<p>If you want to declare variables that not exposed to Inspector, or run any initialization code when the class is created, put your code in <code>onLoad</code> function:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> MyClass = cc.Class({ <span class="hljs-comment">// use cc.Class to define your class</span>
    extends: cc.Behavior,
    onLoad: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.myVariable = <span class="hljs-number">1</span>;
    }
});</code></pre><p>Event if <code>this.myVariable</code> is not shown in Inspector. It&#39;s still accessible via other scripts. Again, more details can be found at <a href="./access-script.html">Access Scripts</a>.</p>
<h2 id="update">Update</h2>
<p><code>update</code> is another function that will be called by lifecycle control.</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> MyClass = cc.Class({ <span class="hljs-comment">// use cc.Class to define your class</span>
    extends: cc.Behavior,
    properties: {
        myCounter: <span class="hljs-number">0</span>
    }
    update: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>.myCounter++;
        cc.log(<span class="hljs-keyword">this</span>.myCounter);
    }
});</code></pre><p><code>update</code> function will be called every frame by game engine. For different game engine the exact timing of <code>update</code> in program lifecycle may differ. Usually it&#39;s before rendering happens for each frame.</p>
<p>The above example will increase <code>this.myCounter</code> by one each frame, and log the value to Cocos Creator console view.</p>
<h2 id="game-engine-api">Game Engine API</h2>
<p>In your FireClass script, you can use any game engine API, including creating a class instance defined in a pure game engine script.</p>
<p>Let&#39;s take Cocos2d-js engine API for example. If we&#39;d like to set position for the current node. We have to rely on Cocos2d-js API:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> MyClass = cc.Class({
    extends: cc.Behavior,
    properties: {
        targetPosX: <span class="hljs-number">0</span>,
        targetPosY: <span class="hljs-number">0</span>
    }
    changePosition: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">// call cc.Node.setPosition(x,y) to change node position</span>
        <span class="hljs-keyword">this</span>.setPosition(<span class="hljs-keyword">this</span>.targetPosX, <span class="hljs-keyword">this</span>.targetPosY);
    }
});</code></pre><p>Don&#39;t worry if you&#39;re not Cocos2d-js user, the only thing that matters is you can use your favorite engine&#39;s API in FireClass.</p>
<p>You can see exactly what you should do for writing script for a specific engine:</p>
<ul class="list">
<li><a href="runtimes/cocos2d-js.html">Cocos2d-js</a></li>
<li>Pixi (coming soon)</li>
<li>Phaser (coming soon)</li>
</ul>
      </article>
    </div>
  </div>
  <script src="../../assets/js/anchor.min.js"></script>
  <script>
    anchors.add('article h2, article h3, article h4');
  </script>
  </body>
</html>
