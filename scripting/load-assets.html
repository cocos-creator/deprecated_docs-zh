<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>获取资源</title>
    <link type="text/css" rel="stylesheet" href="../assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/hljs-github.min.css"/>
    <link type="text/css" rel="stylesheet" href="../assets/css/style.css"/>
    <link rel="shortcut icon" type="image/ico" href="../assets/favicon.ico">
  </head>
  <body>
  <div class="full-wrap">
    <div class="sidebar markdown-body">
      <div class="inner">
        <div class="logo">
          <a href="../index.html"><img src="../assets/img/logo.png"></a>
        </div>
        <ul class="nav nav-list">
          <li class="sidebar-header-1 "><h3><a href="../getting-started/index.html">Cocos Creator 入门</a></h3></li>
          <li class=" sidebar-header-3"><a href="../getting-started/introduction.html">关于 Cocos Creator</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/install.html">安装和启动</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/dashboard.html">使用 Dashboard</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/hello-world.html">Hello World!</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/quick-start.html">快速上手: 制作第一个游戏</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/cocos2d-x-guide.html">Cocos2d-x 用户上手指南</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/unity-guide.html">Unity 用户上手指南</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/project-structure.html">项目结构</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/support.html">获取帮助和支持</a></li>
          <li class="sidebar-header-1 "><h3><a href="../basics/index.html">编辑器基础</a></h3></li>
          <li class=" sidebar-header-3"><a href="../basics/editor-overview.html">编辑器界面介绍</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/assets.html">资源管理器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/scene.html">场景编辑器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/hierarchy.html">层级管理器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/inspector.html">属性检查器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/console.html">控制台</a></li>
          <li class=" sidebar-header-3"><a href="../basics/toolbar.html">工具栏</a></li>
          <li class=" sidebar-header-3"><a href="../basics/layout.html">编辑器布局</a></li>
          <li class="sidebar-header-1 "><h3><a href="../asset-workflow/index.html">资源工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/scene-managing.html">创建和管理场景</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/sprite.html">图像资源（Texture）</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/atlas.html">图集资源（Atlas）</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/font.html">字体资源</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/particle.html">粒子资源</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/audio-asset.html">声音资源（AudioClip）</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/prefab.html">预制资源（Prefab）</a></li>
          <li class="sidebar-header-1 "><h3><a href="../content-workflow/index.html">内容创作工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/node-component.html">节点和组件</a></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/transform.html">坐标系和变换</a></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/node-tree.html">管理节点层级和显示顺序</a></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/scene-editing.html">使用场景编辑器搭建场景图像</a></li>
          <li class="sidebar-header-1 "><h3><a href="../ui/index.html">UI 系统</a></h3></li>
          <li class=" sidebar-header-3"><a href="../ui/sliced-sprite.html">使用 Sliced Sprite 制作 UI 图像</a></li>
          <li class=" sidebar-header-3"><a href="../ui/multi-resolution.html">多分辨率适配方案</a></li>
          <li class=" sidebar-header-3"><a href="../ui/widget-align.html">对齐策略</a></li>
          <li class=" sidebar-header-3"><a href="../ui/label-layout.html">文字排版</a></li>
          <li class=" sidebar-header-3"><a href="../ui/ui-components.html">常用 UI 控件</a></li>
          <li class=" sidebar-header-3"><a href="../ui/auto-layout.html">自动布局容器</a></li>
          <li class=" sidebar-header-3"><a href="../ui/list-with-data.html">制作动态生成内容的列表</a></li>
          <li class="sidebar-header-1 "><h3><a href="../animation/index.html">动画系统</a></h3></li>
          <li class=" sidebar-header-3"><a href="../animation/animation.html">关于 Animation</a></li>
          <li class=" sidebar-header-3"><a href="../animation/animation-clip.html">创建 Animation 组件和动画剪辑</a></li>
          <li class=" sidebar-header-3"><a href="../animation/animation-curve.html">编辑动画曲线</a></li>
          <li class=" sidebar-header-3"><a href="../animation/sprite-animation.html">编辑序列帧动画</a></li>
          <li class=" sidebar-header-3"><a href="../animation/time-curve.html">编辑时间曲线</a></li>
          <li class=" sidebar-header-3"><a href="../animation/animation-event.html">添加动画事件</a></li>
          <li class=" sidebar-header-3"><a href="../animation/scripting-animation.html">使用脚本控制动画</a></li>
          <li class="sidebar-header-1 "><h3><a href="../components/index.html">组件参考</a></h3></li>
          <li class=" sidebar-header-3"><a href="../components/sprite.html">Sprite 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/label.html">Label 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/animation.html">Animation 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/canvas.html">Canvas 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/widget.html">Widget 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/progress.html">ProgressBar 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/button.html">Button 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/mask.html">Mask 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/scrollview.html">ScrollView 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/scrollbar.html">ScrollBar 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/layout.html">Layout 组件参考</a></li>
          <li class="sidebar-header-1 "><h3><a href="index.html">脚本开发工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="use-component.html">创建和使用组件脚本</a></li>
          <li class=" sidebar-header-3"><a href="properties.html">声明属性</a></li>
          <li class=" sidebar-header-3"><a href="access-node-component.html">访问节点和其他组件</a></li>
          <li class=" sidebar-header-3"><a href="life-cycle-callbacks.html">生命周期回调</a></li>
          <li class=" sidebar-header-3"><a href="create-destroy.html">创建和销毁节点</a></li>
          <li class=" sidebar-header-3"><a href="events.html">发射和监听事件</a></li>
          <li class=" sidebar-header-3"><a href="internal-events.html">系统内置事件</a></li>
          <li class=" sidebar-header-3"><a href="actions.html">使用动作系统</a></li>
          <li class=" sidebar-header-3"><a href="action-list.html">动作列表</a></li>
          <li class=" sidebar-header-3"><a href="scheduler.html">使用计时器</a></li>
          <li class=" sidebar-header-3"><a href="execution-order.html">脚本执行顺序</a></li>
          <li class=" sidebar-header-3"><a href="pooling.html">使用对象池</a></li>
          <li class="active sidebar-header-3"><a href="load-assets.html">获取资源</a></li>
          <li class=" sidebar-header-3"><a href="modular-script.html">模块化脚本</a></li>
          <li class=" sidebar-header-3"><a href="web-debug-scripts.html">在浏览器中调试脚本</a></li>
          <li class=" sidebar-header-3"><a href="javascript-primer.html">JavaScript 快速入门</a></li>
          <li class=" sidebar-header-4"><a href="reference/attributes.html">属性参数参考</a></li>
          <li class="sidebar-header-1 "><h3><a href="../publish/index.html">跨平台发布游戏</a></h3></li>
          <li class=" sidebar-header-3"><a href="../publish/publish-web.html">发布到 Web 平台</a></li>
          <li class=" sidebar-header-3"><a href="../publish/cocos-framework.html">安装配置 Cocos Framework</a></li>
          <li class=" sidebar-header-3"><a href="../publish/publish-native.html">打包发布原生平台</a></li>
        </ul>
      </div>
    </div>
    <div class="main">
      <article class="markdown-body"><h1 id="-">获取资源</h1>
<p>Cocos Creator 有一套统一的资源管理机制 ，在本篇教程，我们将介绍</p>
<ul class="list">
<li>资源的分类</li>
<li>如何在 <strong>属性检查器</strong> 里设置资源</li>
<li>Asset 如何通过 url 动态加载</li>
<li>如何获得 Raw Asset 的 url</li>
</ul>
<h2 id="--1">资源的分类</h2>
<p>目前的资源分成两种，一种叫做 <strong>Asset</strong>，一种叫做 <strong>Raw Asset</strong>。</p>
<h3 id="asset">Asset</h3>
<p><code>cc.SpriteFrame</code>, <code>cc.AnimationClip</code>, <code>cc.Prefab</code> 等大部分资源都属于 Asset。Asset 的加载是统一并且自动化的，相互依赖的 Asset 能够被自动预加载。</p>
<blockquote>
<p>例如，当引擎在加载场景时，会先自动加载场景关联到的资源，这些资源如果再关联其它资源，其它也会被先被加载，等加载全部完成后，场景加载才会结束。</p>
</blockquote>
<p>因此只要你拿到了一个 Asset 对象，这个对象一定是已经加载结束的，可以直接通过对象上的属性访问到资源的所有数据。当你要在引擎中使用这些资源，引擎的 API 接收的都必须是一个加载好的 Asset 对象。</p>
<h3 id="raw-asset">Raw Asset</h3>
<p>原先 Cocos2d 已有的一些 API 接收的并不是上面提到的 Asset 对象，而是一个字符串表示的 url，这些旧 API 使用的资源类型就被称为 Raw Asset。<code>cc.Texture2D</code>, <code>cc.Font</code>, <code>cc.AudioClip</code> 都是 Raw Asset。当你要在引擎中使用 Raw Asset，只需要把资源的 url 传给引擎的 API，引擎内部会自动加载这个 url 代表的资源。</p>
<p>假设要在 CCClass 里声明一个类型是 <code>cc.Texture2D</code> 的 Raw Asset 属性，一开始可能会想这样定义：  </p>
<pre class="hljs"><code>cc.Class({
    extends: cc.Component,
    properties: {

        textureURL: {
            <span class="hljs-keyword">default</span>: <span class="hljs-literal">null</span>,
            type: cc.Texture2D
        }

    }
});</code></pre><p>这样写的问题在于，在代码中 <code>textureURL</code> 实际上是一个字符串，而不是 <code>cc.Texture2D</code> 的实例。为了不混淆这里的 type，在 CCClass 中声明 Raw Asset 的属性时，要用 <code>url: cc.Texture2D</code> 而不是 <code>type: cc.Texture2D</code>。</p>
<pre class="hljs"><code>cc.Class({
    extends: cc.Component,
    properties: {

        textureURL: {
            <span class="hljs-keyword">default</span>: <span class="hljs-string">""</span>,
            url: cc.Texture2D
        }

    }
});</code></pre><h2 id="--2">如何在属性检查器里设置资源</h2>
<p>不论是 Asset 还是 Raw Asset，只要在脚本中定义好类型，就能直接在 <strong>属性检查器</strong> 很方便地设置资源。假设我们有这样一个组件：</p>
<pre class="hljs"><code><span class="hljs-comment">// NewScript.js</span>

cc.Class({
    extends: cc.Component,
    properties: {

        textureURL: {
            <span class="hljs-keyword">default</span>: <span class="hljs-string">""</span>,
            url: cc.Texture2D
        },
        spriteFrame: {
            <span class="hljs-keyword">default</span>: <span class="hljs-literal">null</span>,
            type: cc.SpriteFrame
        },

    }
});</code></pre><p>将它添加到场景后，<strong>属性检查器</strong> 里是这样的：</p>
<p class="img-container"><img src="load-assets/asset-in-inspector-null.png" alt="asset-in-inspector-null"></p>
<p>接下来我们从 <strong>资源管理器</strong> 里面分别将一张贴图和一个 SpriteFrame 拖到 <strong>属性检查器</strong> 的对应属性中：</p>
<p class="img-container"><img src="load-assets/asset-in-inspector-dnd.png" alt="asset-in-inspector-dnd"></p>
<p>结果如下：</p>
<p class="img-container"><img src="load-assets/asset-in-inspector.png" alt="asset-in-inspector-dnd"></p>
<p>这样就能在脚本里直接拿到设置好的资源：</p>
<pre class="hljs"><code>    onLoad: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> spriteFrame = <span class="hljs-keyword">this</span>.spriteFrame;
        <span class="hljs-keyword">var</span> textureURL = <span class="hljs-keyword">this</span>.textureURL;

        spriteFrame.setTexture(textureURL);
    }</code></pre><p>在 <strong>属性检查器</strong> 里设置资源虽然很直观，但资源只能在场景里预先设好，没办法动态切换。如果需要动态切换，你需要看看下面的内容。</p>
<h2 id="asset-url-">Asset 如何通过 url 动态加载</h2>
<p>(Coming Soon...)</p>
<h2 id="-raw-asset-url">如何获得 Raw Asset 的 url</h2>
<p>如果你有一张贴图 <code>assets/res/textures/star.png</code>，直接在引擎中使用这个 url 是加载不到的。</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> texture = cc.textureCache.addImage(<span class="hljs-string">"assets/res/textures/star.png"</span>);   <span class="hljs-comment">// 报错！文件找不到</span></code></pre><p>你需要通过 <code>cc.url.raw</code> 进行一次 url 的转换：</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> realUrl = cc.url.raw(<span class="hljs-string">"res/textures/star.png"</span>);
<span class="hljs-keyword">var</span> texture = cc.textureCache.addImage(realUrl);   <span class="hljs-comment">// OK!</span></code></pre>      </article>
    </div>
  </div>
  <script src="../assets/js/anchor.min.js"></script>
  <script>
    anchors.add('article h2, article h3, article h4');
  </script>
  </body>
</html>
