<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>在 Cocos Creator 中使用动作系统</title>
    <link type="text/css" rel="stylesheet" href="../assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/hljs-github.min.css"/>
    <link type="text/css" rel="stylesheet" href="../assets/css/style.css"/>
    <link rel="shortcut icon" type="image/ico" href="../assets/favicon.ico">
  </head>
  <body>
  <div class="full-wrap">
    <div class="sidebar markdown-body">
      <div class="inner">
        <div class="logo">
          <a href="../index.html"><img src="../assets/img/logo.png"></a>
        </div>
        <ul class="nav nav-list">
          <li class="sidebar-header-1 "><h3><a href="../getting-started/index.html">Cocos Creator 入门</a></h3></li>
          <li class=" sidebar-header-3"><a href="../getting-started/introduction.html">关于 Cocos Creator</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/install.html">安装和启动</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/dashboard.html">使用 Dashboard</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/hello-world.html">Hello World!</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/quick-start.html">快速上手: 制作第一个游戏</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/cocos2d-x-guide.html">Cocos2d-x 用户上手指南</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/unity-guide.html">Unity 用户上手指南</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/project-structure.html">项目结构</a></li>
          <li class=" sidebar-header-3"><a href="../getting-started/support.html">获取帮助和支持</a></li>
          <li class="sidebar-header-1 "><h3><a href="../basics/index.html">编辑器基础</a></h3></li>
          <li class=" sidebar-header-3"><a href="../basics/editor-overview.html">编辑器界面介绍</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/assets.html">资源管理器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/scene.html">场景编辑器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/hierarchy.html">层级管理器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/inspector.html">属性检查器</a></li>
          <li class=" sidebar-header-4"><a href="../basics/editor-panels/console.html">控制台</a></li>
          <li class=" sidebar-header-3"><a href="../basics/toolbar.html">工具栏</a></li>
          <li class=" sidebar-header-3"><a href="../basics/layout.html">编辑器布局</a></li>
          <li class="sidebar-header-1 "><h3><a href="../asset-workflow/index.html">资源工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/scene-managing.html">创建和管理场景</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/sprite.html">图像资源（Texture）</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/atlas.html">图集资源（Atlas）</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/font.html">字体资源</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/particle.html">粒子资源</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/audio-asset.html">声音资源（AudioClip）</a></li>
          <li class=" sidebar-header-3"><a href="../asset-workflow/prefab.html">预制资源（Prefab）</a></li>
          <li class="sidebar-header-1 "><h3><a href="../content-workflow/index.html">内容创作工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/node-component.html">节点和组件</a></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/transform.html">坐标系和变换</a></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/node-tree.html">管理节点层级和显示顺序</a></li>
          <li class=" sidebar-header-3"><a href="../content-workflow/scene-editing.html">使用场景编辑器搭建场景图像</a></li>
          <li class="sidebar-header-1 "><h3><a href="../ui/index.html">UI 系统</a></h3></li>
          <li class=" sidebar-header-3"><a href="../ui/sliced-sprite.html">使用 Sliced Sprite 制作 UI 图像</a></li>
          <li class=" sidebar-header-3"><a href="../ui/multi-resolution.html">多分辨率适配方案</a></li>
          <li class=" sidebar-header-3"><a href="../ui/widget-align.html">对齐策略</a></li>
          <li class=" sidebar-header-3"><a href="../ui/label-layout.html">文字排版</a></li>
          <li class=" sidebar-header-3"><a href="../ui/ui-components.html">常用 UI 控件</a></li>
          <li class=" sidebar-header-3"><a href="../ui/auto-layout.html">自动布局容器</a></li>
          <li class=" sidebar-header-3"><a href="../ui/list-with-data.html">制作动态生成内容的列表</a></li>
          <li class="sidebar-header-1 "><h3><a href="../animation/index.html">动画系统</a></h3></li>
          <li class=" sidebar-header-3"><a href="../animation/animation.html">关于 Animation</a></li>
          <li class=" sidebar-header-3"><a href="../animation/animation-clip.html">创建 Animation 组件和动画剪辑</a></li>
          <li class=" sidebar-header-3"><a href="../animation/animation-curve.html">编辑动画曲线</a></li>
          <li class=" sidebar-header-3"><a href="../animation/sprite-animation.html">编辑序列帧动画</a></li>
          <li class=" sidebar-header-3"><a href="../animation/time-curve.html">编辑时间曲线</a></li>
          <li class=" sidebar-header-3"><a href="../animation/animation-event.html">添加动画事件</a></li>
          <li class=" sidebar-header-3"><a href="../animation/scripting-animation.html">使用脚本控制动画</a></li>
          <li class="sidebar-header-1 "><h3><a href="../components/index.html">组件参考</a></h3></li>
          <li class=" sidebar-header-3"><a href="../components/sprite.html">Sprite 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/label.html">Label 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/animation.html">Animation 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/canvas.html">Canvas 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/widget.html">Widget 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/progress.html">ProgressBar 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/button.html">Button 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/mask.html">Mask 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/scrollview.html">ScrollView 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/scrollbar.html">ScrollBar 组件参考</a></li>
          <li class=" sidebar-header-3"><a href="../components/layout.html">Layout 组件参考</a></li>
          <li class="sidebar-header-1 "><h3><a href="index.html">脚本开发工作流程</a></h3></li>
          <li class=" sidebar-header-3"><a href="use-component.html">创建和使用组件脚本</a></li>
          <li class=" sidebar-header-3"><a href="properties.html">声明属性</a></li>
          <li class=" sidebar-header-3"><a href="access-node-component.html">访问节点和其他组件</a></li>
          <li class=" sidebar-header-3"><a href="life-cycle-callbacks.html">生命周期回调</a></li>
          <li class=" sidebar-header-3"><a href="create-destroy.html">创建和销毁节点</a></li>
          <li class=" sidebar-header-3"><a href="events.html">发射和监听事件</a></li>
          <li class=" sidebar-header-3"><a href="internal-events.html">系统内置事件</a></li>
          <li class="active sidebar-header-3"><a href="actions.html">使用动作系统</a></li>
          <li class=" sidebar-header-3"><a href="action-list.html">动作列表</a></li>
          <li class=" sidebar-header-3"><a href="scheduler.html">使用计时器</a></li>
          <li class=" sidebar-header-3"><a href="execution-order.html">脚本执行顺序</a></li>
          <li class=" sidebar-header-3"><a href="pooling.html">使用对象池</a></li>
          <li class=" sidebar-header-3"><a href="load-assets.html">获取资源</a></li>
          <li class=" sidebar-header-3"><a href="modular-script.html">模块化脚本</a></li>
          <li class=" sidebar-header-3"><a href="web-debug-scripts.html">在浏览器中调试脚本</a></li>
          <li class=" sidebar-header-3"><a href="javascript-primer.html">JavaScript 快速入门</a></li>
          <li class=" sidebar-header-4"><a href="reference/attributes.html">属性参数参考</a></li>
          <li class="sidebar-header-1 "><h3><a href="../publish/index.html">跨平台发布游戏</a></h3></li>
          <li class=" sidebar-header-3"><a href="../publish/publish-web.html">发布到 Web 平台</a></li>
          <li class=" sidebar-header-3"><a href="../publish/cocos-framework.html">安装配置 Cocos Framework</a></li>
          <li class=" sidebar-header-3"><a href="../publish/publish-native.html">打包发布原生平台</a></li>
        </ul>
      </div>
    </div>
    <div class="main">
      <article class="markdown-body"><h1 id="-cocos-creator-">在 Cocos Creator 中使用动作系统</h1>
<h2 id="-">动作系统简介</h2>
<p>Cocos Creator 提供的动作系统源自 Cocos2d-x，API 和使用方法均一脉相承。动作系统可以在一定时间内对节点完成位移，缩放，旋转等各种动作。</p>
<p>需要注意的是，动作系统并不能取代<a href="../animation/index.html">动画系统</a>，动作系统提供的是面向程序员的 API 接口，而动画系统则是提供在编辑器中来设计的。同时，他们服务于不同的使用场景，动作系统比较适合来制作简单的形变和位移动画，而动画系统则强大许多，美术可以用编辑器制作支持各种属性，包含运动轨迹和缓动的复杂动画。</p>
<h2 id="-api">动作系统 API</h2>
<p>动作系统的使用方式也很简单，在 <code>cc.Node</code> 中支持如下 API：</p>
<pre class="hljs"><code><span class="hljs-comment">// 创建一个移动动作</span>
var action = cc.moveTo(<span class="hljs-number">2</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
<span class="hljs-comment">// 执行动作</span>
node.runAction(action);
<span class="hljs-comment">// 停止一个动作</span>
node.stopAction(action);
<span class="hljs-comment">// 停止所有动作</span>
node.stopActions();</code></pre><p>开发者还可以给动作设置 tag，并通过 tag 来控制动作。</p>
<pre class="hljs"><code><span class="hljs-comment">// 给 action 设置 tag</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> ACTION_TAG</span> = <span class="hljs-number">1</span>;
action.setTag(ACTION_TAG);
<span class="hljs-comment">// 通过 tag 获取 action</span>
node.getActionByTag(ACTION_TAG);
<span class="hljs-comment">// 通过 tag 停止一个动作</span>
node.stopActionByTag(ACTION_TAG);</code></pre><h2 id="--1">动作类型</h2>
<p>在 Cocos Creator 中支持非常丰富的各种动作，这些动作主要分为几大类：
（由于动作类型过多，在这里不展开描述每个动作的用法，开发者可以参考<a href="./action-list.html">动作系统 API 列表</a>来查看所有动作）</p>
<h3 id="--2">基础动作</h3>
<p>基础动作就是实现各种形变，位移动画的动作，比如 <code>cc.moveTo</code> 用来移动节点到某个位置；<code>cc.rotateBy</code> 用来旋转节点一定的角度；<code>cc.scaleTo</code> 用来缩放节点。</p>
<p>基础动作中分为时间间隔动作和即时动作，前者是在一定时间间隔内完成的渐变动作，前面提到的都是时间间隔动作，它们全部继承自 <a href="http://fireball-x.com/api/classes/ActionInterval.html"><code>cc.ActionInterval</code></a>。后者则是立即发生的，比如用来调用回调函数的 <code>cc.callFunc</code>；用来隐藏节点的 <code>cc.hide</code>，它们全部继承自 <a href="http://fireball-x.com/api/classes/ActionInstant.html"><code>cc.ActionInstant</code></a>。</p>
<h3 id="--3">容器动作</h3>
<p>容器动作可以以不同的方式将动作组织起来，下面是几种容器动作的用途：</p>
<ol class="list">
<li>顺序动作 <code>cc.sequence</code>
 顺序动作可以让一系列子动作按顺序一个个执行。示例：<pre class="hljs"><code> <span class="hljs-comment">// 让节点左右来回移动</span>
 var seq = cc.sequence(cc.moveBy(<span class="hljs-number">0.5</span>, <span class="hljs-number">200</span>, <span class="hljs-number">0</span>), cc.moveBy(<span class="hljs-number">0.5</span>, -<span class="hljs-number">200</span>, <span class="hljs-number">0</span>));
 node.runAction(seq);</code></pre></li>
<li>同步动作 <code>cc.spawn</code>
 同步动作可以同步执行对一系列子动作，子动作的执行结果会叠加起来修改节点的属性。示例：<pre class="hljs"><code> <span class="hljs-comment">// 让节点在向上移动的同时缩放</span>
 var spawn = cc.spawn(cc.moveBy(<span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>), cc.scaleTo(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">1.4</span>));
 node.runAction(spawn);</code></pre></li>
<li>重复动作 <code>cc.repeat</code>
 重复动作用来多次重复一个动作。示例：<pre class="hljs"><code> <span class="hljs-comment">// 让节点左右来回移动，并重复5次</span>
 var seq = cc.repeat(
             cc.sequence(
                 cc.moveBy(<span class="hljs-number">2</span>, <span class="hljs-number">200</span>, <span class="hljs-number">0</span>), 
                 cc.moveBy(<span class="hljs-number">2</span>, -<span class="hljs-number">200</span>, <span class="hljs-number">0</span>)
             ), <span class="hljs-number">5</span>);
 node.runAction(seq);</code></pre></li>
<li>永远重复动作 <code>cc.repeatForever</code>
 顾名思义，这个动作容器可以让目标动作一直重复，直到手动停止。<pre class="hljs"><code> <span class="hljs-comment">// 让节点左右来回移动并一直重复</span>
 var seq = cc.repeatForever(
             cc.sequence(
                 cc.moveBy(<span class="hljs-number">2</span>, <span class="hljs-number">200</span>, <span class="hljs-number">0</span>), 
                 cc.moveBy(<span class="hljs-number">2</span>, -<span class="hljs-number">200</span>, <span class="hljs-number">0</span>)
             ));</code></pre></li>
<li>速度动作 <code>cc.speed</code>
 速度动作可以改变目标动作的执行速率，让动作更快或者更慢完成。<pre class="hljs"><code> <span class="hljs-comment">// 让目标动作速度加快一倍，相当于原本2秒的动作在1秒内完成</span>
 var action = cc.speed(
                 cc.spawn(
                     cc.moveBy(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>), 
                     cc.scaleTo(<span class="hljs-number">2</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">1.4</span>)
                 ), <span class="hljs-number">0.5</span>);
 node.runAction(action);</code></pre></li>
</ol>
<p>从上面的示例中可以看出，不同容器类型是可以复合的，初次之外，我们给容器类型动作提供了更为方便的链式 API，动作对象支持以下三个 API：<code>repeat</code>、<code>repeatForever</code>、<code>speed</code>，这些 API 都会返回动作对象本身，支持继续链式调用。我们来看一个更复杂的动作示例：</p>
<pre class="hljs"><code><span class="hljs-comment">// 一个复杂的跳跃动画</span>
<span class="hljs-keyword">this</span>.jumpAction = cc.sequence(
    cc.spawn(
        cc.scaleTo(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">1.2</span>),
        cc.moveTo(<span class="hljs-number">0.1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>)
    ),
    cc.spawn(
        cc.ScaleTo.create(<span class="hljs-number">0.2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),
        cc.MoveTo.create(<span class="hljs-number">0.2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    ),
    cc.delayTime(<span class="hljs-number">0.5</span>),
    cc.spawn(
        cc.ScaleTo.create(<span class="hljs-number">0.1</span>, <span class="hljs-number">1.2</span>, <span class="hljs-number">0.8</span>),
        cc.MoveTo.create(<span class="hljs-number">0.1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">10</span>)
    ),
    cc.spawn(
        cc.ScaleTo.create(<span class="hljs-number">0.2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),
        cc.MoveTo.create(<span class="hljs-number">0.2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    )
<span class="hljs-comment">// 以1/2的速度慢放动画，并重复5次</span>
).speed(<span class="hljs-number">2</span>).repeat(<span class="hljs-number">5</span>);</code></pre><h3 id="--4">缓动动作</h3>
<p>缓动动作不可以单独存在，它永远是为了修饰基础动作而存在的，它可以用来修改基础动作的时间曲线，让动作有快入、缓入、快出或其它更复杂的特效。需要注意的是，只有时间间隔动作才支持缓动：</p>
<pre class="hljs"><code>var aciton = cc.scaleTo(<span class="hljs-number">0.5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);
action.easing(cc.easeIn(<span class="hljs-number">3.0</span>));</code></pre><p>基础的缓动动作类是 <a href="http://fireball-x.com/api/classes/ActionEase.html"><code>cc.ActionEase</code></a>。各种缓动动作的时间曲线可以参考下图：</p>
<p class="img-container"><img src="https://pic2.zhimg.com/cd0cc8c9293bb00738e0762b8370576d_b.jpg" alt=""></p>
<p><em>图片源自 <a href="http://hosted.zeh.com.br/tweener/docs/en-us/">http://hosted.zeh.com.br/tweener/docs/en-us/</a></em></p>
<h2 id="-api-">具体动作 API 参考</h2>
<p>接下来请参考<a href="./action-list.html">动作系统 API 列表</a>来了解有哪些动作系统接口可以使用。</p>
      </article>
    </div>
  </div>
  <script src="../assets/js/anchor.min.js"></script>
  <script>
    anchors.add('article h2, article h3, article h4');
  </script>
  </body>
</html>
