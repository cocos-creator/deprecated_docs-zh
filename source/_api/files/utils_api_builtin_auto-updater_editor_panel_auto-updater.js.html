<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>utils/api/builtin/auto-updater/editor/panel/auto-updater.js - fireball-build</title>
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="../assets/vendor/yui-min.js"></script>
</head>
<body>

<div id="doc">
    <header class="main-header">
        <div class="content">
            <div class="project-title">
                <a href="http://docs-zh.fireball-x.com">
                        <img class="logo" src="http://docs-zh.fireball-x.com/images/logo.png" title="fireball-build">
                </a>
                    <h1 class="project-name">fireball-build</h1> <span class="project-version">0.3.0</span>
                    <p class="description">Fireball is the game engine for the future.</p>
            </div>
            <ul class="jump-links">
                <li><a href="#index" class="index-jump-link">index</a></li>
                <li><a href="#top" class="top-jump-link">top</a></li>
            </ul>
        </div>
    </header>
    <div id="bd" class="main-body">

        <div id="docs-sidebar" class="sidebar apidocs"><div id="api-list">
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-enums">枚举</a></li>
            <li><a href="#api-classes">类型</a></li>
            <li><a href="#api-modules">模组</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="输入关键词，过滤API">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-enums" class="apis enums">
                <li>
                    <a href="../enums/FontType.html">FontType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/TextAlign.html">TextAlign</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/TextAnchor.html">TextAnchor</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
            </ul>

            <ul id="api-classes" class="apis classes">
                <li>
                    <a class="type" href="../classes/_CallbacksHandler.html">_CallbacksHandler</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/_DeserializeInfo.html">_DeserializeInfo</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/_ObjectFlags.html">_ObjectFlags</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/_Runtime.RenderContext.html">_Runtime.RenderContext</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/AnimationNode.html">AnimationNode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/AnimCurve.html">AnimCurve</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Asset.html">Asset</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/AssetBundleBase.html">AssetBundleBase</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/AssetLibrary.html">AssetLibrary</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/AtlasAsset.html">AtlasAsset</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="type" href="../classes/AudioClip.html">AudioClip</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/AudioSource.html">AudioSource</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/BitmapFont.html">BitmapFont</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/BitmapText.html">BitmapText</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/CallbacksInvoker.html">CallbacksInvoker</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Camera.html">Camera</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Color.html">Color</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Component.html">Component</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/ContentStrategyType.html">ContentStrategyType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/DynamicAnimCurve.html">DynamicAnimCurve</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Engine.html">Engine</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Entity.html">Entity</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/EqualToFrame.html">EqualToFrame</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Event.html">Event</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/EventTarget.html">EventTarget</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/FixedHeight.html">FixedHeight</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/FObject.html">FObject</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/FontFlagType.html">FontFlagType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/HashObject.html">HashObject</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Input.html">Input</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/InputField.html">InputField</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Intersection.html">Intersection</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/KeyboardEvent.html">KeyboardEvent</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/LoadManager.html">LoadManager</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Matrix23.html">Matrix23</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/ModifierKeyStates.html">ModifierKeyStates</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/MouseEvent.html">MouseEvent</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/NoScale.html">NoScale</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Path.html">Path</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Playable.html">Playable</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/PlaybackDirection.html">PlaybackDirection</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Rect.html">Rect</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Renderer.html">Renderer</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Resources.html">Resources</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/ResourcesBundle.html">ResourcesBundle</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Screen.html">Screen</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Screen.ContainerStrategy.html">Screen.ContainerStrategy</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Screen.ContentStrategy.html">Screen.ContentStrategy</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Skeleton.html">Skeleton</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="type" href="../classes/SkeletonDataAsset.html">SkeletonDataAsset</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="type" href="../classes/SkeletonRenderer.html">SkeletonRenderer</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="type" href="../classes/Sprite.html">Sprite</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/SpriteAnimation.html">SpriteAnimation</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/SpriteAnimationClip.html">SpriteAnimationClip</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/SpriteAnimationClip.StopAction.html">SpriteAnimationClip.StopAction</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/SpriteAnimationClip.WrapMode.html">SpriteAnimationClip.WrapMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/SpriteAnimationState.html">SpriteAnimationState</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/SpriteRenderer.html">SpriteRenderer</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Texture.html">Texture</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Texture.FilterMode.html">Texture.FilterMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Texture.WrapMode.html">Texture.WrapMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Time.html">Time</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Transform.html">Transform</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="type" href="../classes/Vec2.html">Vec2</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
            </ul>

            <ul id="api-modules" class="apis modules">
                <li><a class="module" href="../modules/Editor.html">Editor</a></li>
                <li><a class="module" href="../modules/Fire.html">Fire</a></li>
                <li><a class="module" href="../modules/Fire.JS.html">Fire.JS</a></li>
                <li><a class="module" href="../modules/Fire.Spine.html">Fire.Spine</a></li>
                <li><a class="module" href="../modules/Math.html">Math</a></li>
            </ul>
        </div>
    </div>
</div>
</div>

        <div id="docs-main" class="apidocs">
            <div class="content container"><h1 class="file-heading">文件: utils/api/builtin/auto-updater/editor/panel/auto-updater.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module Fire
 */
var Remote = require(&#x27;remote&#x27;);
var App = Remote.require(&#x27;app&#x27;);
//var AutoUpdater = Remote.require(&#x27;auto-updater&#x27;);

Polymer({
    version: &#x27;&#x27;,
    newVersion: &#x27;&#x27;,
    playing: false,
    status: &quot;normal&quot;,
    progressAnimate: false,
    statusTip: &quot;&quot;,
    hasNewVersion: false,
    confirmLabel: &quot;Yes&quot;,
    cancelLabel: &quot;No&quot;,
    //ignoreDialog: false,
    //winUpdate: false,
    //updateUrl: &quot;&quot;,
    showConfirm: false,
    showClose: false,

    created: function () {
        this.version = App.getVersion();
    },

    &#x27;panel:open&#x27;: function ( argv ) {
        this.status = argv.status;
        Editor.sendToCore( &#x27;auto-updater:opened&#x27;, {status: this.status});
    },

    &#x27;auto-updater:status-changed&#x27;: function (opts) {
        console.log(&quot;status changed: &quot; + JSON.stringify(opts));
        this.status = opts.status;
        switch( opts.status ) {
            case &quot;checking&quot;:
                console.log(&quot;checking&quot;);
                this.playAnimation();
                this.statusTip = &quot;Checking for update...&quot;;
                this.showClose = false;
                break;
            case &quot;not-available&quot;:
                this.progressAnimate = false;
                this.playing = false;
                this.showConfirm = false;
                this.showClose = true;
                this.statusTip = &quot;Your Fireball Version is up to date!&quot;;
                break;
            case &quot;confirm-download&quot;:
                this.playing = false;
                this.showConfirm = true;
                this.showClose = false;
                this.hasNewVersion = true;
                this.newVersion = opts.newVersion;
                this.confirmLabel = &quot;Download&quot;;
                this.cancelLabel = &quot;Cancel&quot;;
                this.statusTip = &quot;New version found! Should start downloading &quot; + opts.filename + &quot;?&quot;;
                break;
            case &quot;downloading&quot;:
                this.progressAnimate = true;
                this.playing = true;
                this.showConfirm = false;
                this.showClose = false;
                this.statusTip = &quot;Start downloading in the background... this window is closing in 3 seconds&quot;;
                break;
            case &quot;confirm-replace&quot;:
                this.progressAnimate = false;
                this.playing = false;
                this.showConfirm = true;
                this.showClose = false;
                this.confirmLabel = &quot;Close App and Update&quot;;
                this.cancelLabel = &quot;Cancel&quot;;
                this.statusTip = &quot;Download latest Fireball complete, should we CLOSE the app and go to the new version location?&quot;;
                break;

            //case &quot;error&quot;:
            //    this.playing = false;
            //    this.statusTip = &quot;Error: install faild,please quite and check update again!&quot;;
            //    break;
            //
            //case &quot;downloaded&quot;:
            //    this.playing = false;
            //    this.statusTip = &quot;Download success,ready to install...&quot;;
            //    if (!this.ignoreDialog) {
            //        var dialog = Remote.require(&#x27;dialog&#x27;);
            //        var result = dialog.showMessageBox( Remote.getCurrentWindow(), {
            //            type: &quot;warning&quot;,
            //            buttons: [&quot;Quite and install now&quot;,&quot;Later&quot;],
            //            title: &quot;Install Update&quot;,
            //            message: &quot;install update now?&quot;,
            //            detail: &quot;If you choose \&quot;Later\&quot;, Fireball will update itself after you quit the app.&quot;
            //        } );
            //
            //        if (result === 0) {
            //            //AutoUpdater.quitAndInstall();
            //        }
            //        // else if (result === 1) {
            //        // TODO: send ipc to MainWindow, so that if MainWindow close, it should call autoUpdater.quitAndInstall();
            //        // }
            //    }
            //    break;
        }
    },

    //darwinCheckUpdate: function () {
    //    Editor.sendToCore( &#x27;auto-updater:start&#x27;);
    //    this.playAnimation();
    //},
    //
    //windowsCheckUpdate: function () {
    //    this.playAnimation();
    //    Fire._JsonLoader(&#x27;http://fireball-x.com/api/checkupdate?version=v&#x27;+ app.getVersion(), function (err,json) {
    //        this.progressAnimate = true;
    //        Fire.log(&quot;Checking for update!&quot;);
    //        this.statusTip = &quot;Checking for update...&quot;;
    //        if (err) {
    //            this.statusTip = &quot;Update not available...&quot;;
    //            Fire.warn(&quot;Update not available...&quot;);
    //            this.progressAnimate = false;
    //        }
    //        else {
    //            this.statusTip = &quot;New version for update!&quot;;
    //            Fire.info(&quot;New version for update! You should open this url to download: &#x27;&quot; + json.url + &quot;&#x27;&quot;);
    //            this.winUpdate = true;
    //            this.updateUrl = json.winurl;
    //        }
    //    }.bind(this));
    //},
    //
    //ipcStatusChanged: function ( event ) {
    //    this.status = event.detail.status;
    //    this.ignoreDialog = event.detail.ignoreDialog;
    //},

    playAnimation: function () {
        this.playing = true;
        this.$.logo.animate([
            { width: &quot;45px&quot; },
            { width: &quot;40px&quot; },
        ], {
            duration: 200
        });

        this.$.logo.style.width = &quot;40px&quot;;
    },

    //install: function () {
        //AutoUpdater.quitAndInstall();
    //},

    //goToUpdateUrl: function () {
    //    var shell = Remote.require(&#x27;shell&#x27;);
    //    shell.openExternal(this.updateUrl);
    //},

    confirm: function () {
        //console.log(&#x27;click confirm&#x27;);
        Editor.sendToCore( &#x27;auto-updater:on-confirm&#x27;, {status: this.status});
    },
    cancel: function () {
        //console.log(&#x27;click cancel&#x27;);
        Editor.sendToCore( &#x27;auto-updater:on-cancel&#x27;, {status: this.status});
    }
});

    </pre>
</div>
</div>
        </div>

    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/vendor/jquery.min.js"></script>
<script src="../assets/js/jquery-offscreen-trigger.js"></script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
