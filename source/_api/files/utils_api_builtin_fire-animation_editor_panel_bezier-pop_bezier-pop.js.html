<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>utils/api/builtin/fire-animation/editor/panel/bezier-pop/bezier-pop.js - fireball-build</title>
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="../assets/vendor/yui-min.js"></script>
</head>
<body>

<div id="doc">
    <header class="main-header">
        <div class="content">
            <div class="project-title">
                <a href="http://docs-zh.fireball-x.com">
                        <img class="logo" src="http://docs-zh.fireball-x.com/images/logo.png" title="fireball-build">
                </a>
                    <h1 class="project-name">fireball-build</h1> <span class="project-version">0.4.0</span>
                    <p class="description">Fireball is the game engine for the future.</p>
            </div>
            <ul class="jump-links">
                <li><a href="#index" class="index-jump-link">index</a></li>
                <li><a href="#top" class="top-jump-link">top</a></li>
            </ul>
        </div>
    </header>
    <div id="bd" class="main-body">

        <div id="docs-sidebar" class="sidebar apidocs"><div id="api-list">
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">类型</a></li>
            <li><a href="#api-modules">模组</a></li>
            <li><a href="#api-enums">枚举</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="输入关键词，过滤API">
        </div>

        <div id="api-tabview-panel">

            <ul id="api-classes" class="apis classes">
                <li>
                    <a class="class" href="../classes/_CallbacksHandler.html">_CallbacksHandler</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/_DeserializeInfo.html">_DeserializeInfo</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/_ObjectFlags.html">_ObjectFlags</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/_Runtime.RenderContext.html">_Runtime.RenderContext</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Animation.html">Animation</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AnimationNode.html">AnimationNode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AnimationNodeBase.html">AnimationNodeBase</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AnimationState.html">AnimationState</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Array.html">Array</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Asset.html">Asset</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AssetBundleBase.html">AssetBundleBase</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AssetLibrary.html">AssetLibrary</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AtlasAsset.html">AtlasAsset</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="class" href="../classes/AudioClip.html">AudioClip</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/AudioSource.html">AudioSource</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/BitmapFont.html">BitmapFont</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/BitmapText.html">BitmapText</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/CallbacksInvoker.html">CallbacksInvoker</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Camera.html">Camera</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Color.html">Color</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Component.html">Component</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/ContentStrategyType.html">ContentStrategyType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/EmitterMode.html">EmitterMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Engine.html">Engine</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Entity.html">Entity</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/EqualToFrame.html">EqualToFrame</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Event.html">Event</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/EventTarget.html">EventTarget</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/FixedHeight.html">FixedHeight</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/FObject.html">FObject</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/FontFlagType.html">FontFlagType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/HashObject.html">HashObject</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Input.html">Input</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/InputField.html">InputField</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Intersection.html">Intersection</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/KeyboardEvent.html">KeyboardEvent</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/LoadManager.html">LoadManager</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Matrix23.html">Matrix23</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/ModifierKeyStates.html">ModifierKeyStates</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/MouseEvent.html">MouseEvent</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/NoScale.html">NoScale</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/ParticleSystem.html">ParticleSystem</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Path.html">Path</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Playable.html">Playable</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/PositionType.html">PositionType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Rect.html">Rect</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Renderer.html">Renderer</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Resources.html">Resources</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/ResourcesBundle.html">ResourcesBundle</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Screen.html">Screen</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Screen.ContainerStrategy.html">Screen.ContainerStrategy</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Screen.ContentStrategy.html">Screen.ContentStrategy</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Skeleton.html">Skeleton</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="class" href="../classes/SkeletonDataAsset.html">SkeletonDataAsset</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="class" href="../classes/SkeletonRenderer.html">SkeletonRenderer</a>
                    <a href="../modules/Fire.Spine.html" class="api-list-item-module">@Fire.Spine</a>
                </li>
                <li>
                    <a class="class" href="../classes/Sprite.html">Sprite</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/SpriteAnimation.html">SpriteAnimation</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/SpriteAnimationClip.html">SpriteAnimationClip</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/SpriteAnimationState.html">SpriteAnimationState</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/SpriteRenderer.html">SpriteRenderer</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Text.html">Text</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Texture.FilterMode.html">Texture.FilterMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Texture.Texture.html">Texture.Texture</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Texture.WrapMode.html">Texture.WrapMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Time.html">Time</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Transform.html">Transform</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/ValueType.html">ValueType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a class="class" href="../classes/Vec2.html">Vec2</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
            </ul>

            <ul id="api-modules" class="apis modules">
                <li><a class="module" href="../modules/Editor.html">Editor</a></li>
                <li><a class="module" href="../modules/Fire.html">Fire</a></li>
                <li><a class="module" href="../modules/Fire.JS.html">Fire.JS</a></li>
                <li><a class="module" href="../modules/Fire.Spine.html">Fire.Spine</a></li>
                <li><a class="module" href="../modules/Math.html">Math</a></li>
            </ul>

            <ul id="api-enums" class="apis enums">
                <li>
                    <a href="../enums/Fire.KeyCode.html">Fire.KeyCode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/FontType.html">FontType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/ImageType.html">ImageType</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/SpriteAnimationClip.StopAction.html">SpriteAnimationClip.StopAction</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/SpriteAnimationClip.WrapMode.html">SpriteAnimationClip.WrapMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/TextAlign.html">TextAlign</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/TextAnchor.html">TextAnchor</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
                <li>
                    <a href="../enums/WrapMode.html">WrapMode</a>
                    <a href="../modules/Fire.html" class="api-list-item-module">@Fire</a>
                </li>
            </ul>
        </div>
    </div>
</div>
</div>

        <div id="docs-main" class="apidocs">
            <div class="content container"><h1 class="file-heading">文件: utils/api/builtin/fire-animation/editor/panel/bezier-pop/bezier-pop.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module Fire
 */
Polymer({
    publish: {
        bezier: [],
    },

    svg: null,
    bezierBinding: &#x27;&#x27;,
    selectCurves: [],
    typeIndex: 0,
    move: false,
    _previewProgress: 0,
    _stopPreview: false,

    curves: [
        {
            name: &#x27;Linear&#x27;,
            items: [
                {
                    name: &#x27;Default&#x27;,
                    value: [0.5,0.5,0.5,0.5],
                },
            ],
        },
        {
            name: &#x27;Ease In&#x27;,
            items: [
                {
                    name: &#x27;Cubic&#x27;,
                    value: [0.4,0,0.5,0.5],
                },
                {
                    name: &#x27;Quad&#x27;,
                    value: [0.55,0.08,0.68,0.53],
                },
                {
                    name: &#x27;Quart&#x27;,
                    value: [0.89,0.03,0.68,0.21],
                },
                {
                    name: &#x27;Quint&#x27;,
                    value: [0.75,0.05,0.85,0.06],
                },
                {
                    name: &#x27;Sine&#x27;,
                    value: [0.48,0,0.73,0.71],
                },
                {
                    name: &#x27;Expo&#x27;,
                    value: [0.95,0.04,0.79,0.03],
                },
                {
                    name: &#x27;Circ&#x27;,
                    value: [0.6,0.04,0.98,0.33],
                },
            ],
        },

        {
            name: &#x27;Ease Out&#x27;,
            items: [
                {
                    name: &#x27;Cubic&#x27;,
                    value: [0.06,0.12,0.58,1],
                },
                {
                    name: &#x27;Quad&#x27;,
                    value: [0.25,0.46,0.45,0.95],
                },
                {
                    name: &#x27;Quart&#x27;,
                    value: [0.16,0.84,0.43,1],
                },
                {
                    name: &#x27;Quint&#x27;,
                    value: [0.22,1,0.31,1],
                },
                {
                    name: &#x27;Sine&#x27;,
                    value: [0.39,0.59,0.56,1],
                },
                {
                    name: &#x27;Expo&#x27;,
                    value: [0.18,1,0.22,1],
                },
                {
                    name: &#x27;Circ&#x27;,
                    value: [0.08,0.82,0.01,1],
                },
            ],
        },
        {
            name: &#x27;Ease in out&#x27;,
            items: [
                {
                    name: &#x27;Cubic&#x27;,
                    value: [0.42,0,0.58,1],
                },
                {
                    name: &#x27;Quad&#x27;,
                    value: [0.48,0.04,0.52,0.96],
                },
                {
                    name: &#x27;Quart&#x27;,
                    value: [0.83,0,0.17,1],
                },
                {
                    name: &#x27;Quint&#x27;,
                    value: [0.94,0,0.06,1],
                },
                {
                    name: &#x27;Sine&#x27;,
                    value: [0.46,0.05,0.54,0.95],
                },
                {
                    name: &#x27;Expo&#x27;,
                    value: [1,0,0,1],
                },
                {
                    name: &#x27;Circ&#x27;,
                    value: [0.86,0.14,0.14,0.86],
                },
            ],
        },
        {
            name: &#x27;Back&#x27;,
            items: [
                {
                    name: &#x27;Forward&#x27;,
                    value: [0.18,0.89,0.31,1.21],
                },
                {
                    name: &#x27;Reverse&#x27;,
                    value: [0.6,-0.27,0.73,0.04],
                },
            ],
        },
    ],

    domReady: function () {
        this.svg = this.$.svg;
        this.distance = this.$.curve.getBoundingClientRect().width - 1;
        this.ofX = this.$.curve.offsetLeft;
        this.ofY = this.$.curve.offsetTop;
        if ( this.bezier.length === 0) {
            this.selectCurves = this.curves[0].items[0].value;
            this.changeBezierType(0);
        }else {
            this.loadCustomBezier();
            this.drawBezier();
        }
        this.playPreview();
    },

    changeBezier: function(event) {
        var ele = event.target;
        for (var i = 0; i &lt; ele.parentElement.children.length; i++) {
            ele.parentElement.children[i].removeAttribute(&#x27;active&#x27;);
            if (ele === ele.parentElement.children[i]) {
                this.bezier = this.curves[this.typeIndex].items[i].value.slice(0);
                ele.parentElement.children[i].setAttribute(&#x27;active&#x27;,&#x27;&#x27;);
                this.drawBezier();
            }
        }
    },

    changeBezierType: function (index) {
        this.typeIndex = index;
        if (!index) {
            this.selectCurves = this.curves[0].items.slice(0);
            return;
        }
        this.selectCurves = this.curves[index].items.slice(0);
    },

    curveTypeClickAction: function (event) {
        var ele = event.target;
        for (var i = 0; i &lt; ele.parentElement.children.length; i++) {
            ele.parentElement.children[i].removeAttribute(&#x27;select&#x27;);
            if (ele === ele.parentElement.children[i]) {
                this.changeBezierType(i-1);
                this.typeIndex = i-1;
                ele.setAttribute(&#x27;select&#x27;,&#x27;&#x27;);
            }
        }
    },

    drawBezier: function () {
        if (this.bezier === []) {
            return;
        }
        this.$.svg.innerHTML = &#x27;&#x27;;
        var realBezier = this.realCoord(this.bezier);

        var svgns = &quot;http://www.w3.org/2000/svg&quot;;
        var slash = this.drawLine(this.distance + this.ofX,this.ofY,&#x27;#3e3e3e&#x27;,true);
        slash.setAttribute(&#x27;class&#x27;,&#x27;eventNone&#x27;);
        var path = document.createElementNS(svgns,&quot;path&quot;);
        var d = this.getPath(realBezier);

        path.setAttribute(&quot;d&quot;, d);
        path.setAttribute(&quot;fill&quot;, &quot;none&quot;);
        path.setAttribute(&quot;stroke&quot;, &quot;#e2e2e2&quot;);
        this.$.svg.appendChild(path);

        var line1 = this.drawLine(realBezier[0],realBezier[1],&#x27;#2c7dfd&#x27;,true);
        var line2 = this.drawLine(realBezier[2],realBezier[3],&#x27;#2c7dfd&#x27;,false);

        var spoint = this.drawRect(this.ofX,this.ofY + this.distance);
        var epoint = this.drawRect(this.ofX + this.distance,this.ofY);

        var c1point = this.drawPoint(realBezier[0],realBezier[1]);

        var c2point = this.drawPoint(realBezier[2],realBezier[3]);

        c1point.onmousedown = function () {
            this.move = true;
            this.onmousemove = function (event) {
                if (this.move) {
                    this.$.svg.style.cursor = &#x27;all-scroll&#x27;;
                    var x = event.clientX - this.$.curve.getBoundingClientRect().left + this.ofX;
                    var y = event.clientY - this.$.curve.getBoundingClientRect().top + this.ofY;
                    c1point.setAttribute(&quot;cx&quot;,x);
                    c1point.setAttribute(&quot;cy&quot;,y);
                    line1.setAttribute(&#x27;x2&#x27;,x);
                    line1.setAttribute(&#x27;y2&#x27;,y);
                    realBezier[0] = x;
                    this.bezier[0] = (x - this.ofX) / this.distance;
                    realBezier[1] = y;
                    this.bezier[1] = 1 - ((y - this.ofY) / this.distance);
                    path.setAttribute(&quot;d&quot;, this.getPath(realBezier));
                    this.updateValue();
                }
            };
            this.onmouseup = function () {
                this.$.svg.style.cursor = &#x27;default&#x27;;
                this.move = false;
            };
        }.bind(this);

        c2point.onmousedown = function () {
            this.move = true;
            this.onmousemove = function (event) {
                if (this.move) {
                    this.$.svg.style.cursor = &#x27;all-scroll&#x27;;
                    var x = event.clientX - this.$.curve.getBoundingClientRect().left + this.ofX;
                    var y = event.clientY - this.$.curve.getBoundingClientRect().top + this.ofY;
                    c2point.setAttribute(&quot;cx&quot;,x);
                    c2point.setAttribute(&quot;cy&quot;,y);
                    line2.setAttribute(&#x27;x2&#x27;,x);
                    line2.setAttribute(&#x27;y2&#x27;,y);
                    realBezier[2] = x;
                    this.bezier[2] = (x - this.ofX) / this.distance;
                    realBezier[3] = y;
                    this.bezier[3] = 1 - ( (y - this.ofY) / this.distance);
                    path.setAttribute(&quot;d&quot;, this.getPath(realBezier));
                    this.updateValue();
                }
            };

            this.onmouseup = function () {
                this.$.svg.style.cursor = &#x27;default&#x27;;
                this.move = false;
            };
        }.bind(this);

        line1.onmousedown = function () {
            var x1 = this.ofX;
            var y1 = this.ofY + this.distance;
            EditorUI.addDragGhost(&quot;all-scroll&quot;);
            var mousemoveHandle = function( event ) {
                var x = event.clientX - this.$.curve.getBoundingClientRect().left + this.ofX;
                var y = event.clientY - this.$.curve.getBoundingClientRect().top + this.ofY;
                var newPoint =  this.rotatLine({
                    x: this.bezier[0],
                    y: this.bezier[1]
                },{
                    x: x1,
                    y: y1
                },{
                    x: x,
                    y: y,
                },0);

                line1.setAttribute(&quot;x2&quot;,newPoint.x * this.distance + this.ofX);
                line1.setAttribute(&quot;y2&quot;,(this.ofY + this.distance) - (newPoint.y * this.distance));
                c1point.setAttribute(&quot;cx&quot;,newPoint.x * this.distance + this.ofX);
                c1point.setAttribute(&quot;cy&quot;,(this.ofY + this.distance) - (newPoint.y * this.distance));
                realBezier[0] = newPoint.x * this.distance + this.ofX;
                this.bezier[0] = newPoint.x;
                realBezier[1] = (this.ofY + this.distance) - (newPoint.y * this.distance);
                this.bezier[1] = newPoint.y;
                path.setAttribute(&quot;d&quot;, this.getPath(realBezier));
                this.updateValue();
            }.bind(this);

            var mouseupHandle = function (event) {
                document.removeEventListener(&#x27;mousemove&#x27;, mousemoveHandle);
                document.removeEventListener(&#x27;mouseup&#x27;, mouseupHandle);
                EditorUI.removeDragGhost();
            }.bind(this);

            document.addEventListener ( &#x27;mousemove&#x27;, mousemoveHandle );
            document.addEventListener ( &#x27;mouseup&#x27;, mouseupHandle );
        }.bind(this);

        line2.onmousedown = function () {
            var x1 = this.ofX + this.distance;
            var y1 = this.ofY;
            EditorUI.addDragGhost(&quot;all-scroll&quot;);
            var mousemoveHandle = function( event ) {
                var x = event.clientX - this.$.curve.getBoundingClientRect().left + this.ofX;
                var y = event.clientY - this.$.curve.getBoundingClientRect().top + this.ofY;
                var newPoint =  this.rotatLine({
                    x: this.bezier[2],
                    y: this.bezier[3]
                },{
                    x: x1,
                    y: y1
                },{
                    x: x,
                    y: y,
                },1);

                newPoint = {x: newPoint.x + 1, y: newPoint.y + 1};
                line2.setAttribute(&quot;x2&quot;,newPoint.x * this.distance + this.ofX);
                line2.setAttribute(&quot;y2&quot;,(this.ofY + this.distance) - (newPoint.y * this.distance));
                c2point.setAttribute(&quot;cx&quot;,newPoint.x * this.distance + this.ofX);
                c2point.setAttribute(&quot;cy&quot;,(this.ofY + this.distance) - (newPoint.y * this.distance));
                realBezier[2] = newPoint.x * this.distance + this.ofX;
                this.bezier[2] = newPoint.x;
                realBezier[3] = (this.ofY + this.distance) - (newPoint.y * this.distance);
                this.bezier[3] = newPoint.y;
                path.setAttribute(&quot;d&quot;, this.getPath(realBezier));
                this.updateValue();
            }.bind(this);

            var mouseupHandle = function (event) {
                document.removeEventListener(&#x27;mousemove&#x27;, mousemoveHandle);
                document.removeEventListener(&#x27;mouseup&#x27;, mouseupHandle);
                EditorUI.removeDragGhost();
            }.bind(this);

            document.addEventListener ( &#x27;mousemove&#x27;, mousemoveHandle );
            document.addEventListener ( &#x27;mouseup&#x27;, mouseupHandle );
        }.bind(this);

        this.updateValue();
    },

    realCoord: function (bezier) {
        var realCoord = [
            bezier[0] * this.distance + this.ofX,
            (1 - bezier[1]) * this.distance + this.ofY,
            bezier[2] * this.distance + this.ofX,
            (1 - bezier[3]) * this.distance + this.ofY,
        ];
        return realCoord;
    },

    getPath: function (points)　{
        var dstart = &quot;M&quot;+ this.ofX + &#x27;,&#x27; + (this.ofY + this.distance) + &#x27; &#x27;;
        var controlPoint = &quot;C&quot; + points[0] +
            &#x27;,&#x27; + points[1] +
            &#x27;,&#x27; + points[2] +
            &#x27;,&#x27; + points[3] +
            &#x27;,&#x27; + (this.ofX + this.distance) + &#x27;,&#x27; + (this.ofY) + &#x27; &#x27;;
        var p = dstart + controlPoint;
        return p;
    },

    drawPoint: function (cx,cy) {
        var svgns = &quot;http://www.w3.org/2000/svg&quot;;
        var point = document.createElementNS(svgns,&quot;circle&quot;);
        point.setAttribute(&quot;cx&quot;,cx);
        point.setAttribute(&quot;cy&quot;,cy);
        point.setAttribute(&quot;r&quot;,&quot;3&quot;);
        point.setAttribute(&quot;fill&quot;,&quot;#454544&quot;);
        point.setAttribute(&quot;stroke&quot;,&quot;white&quot;);
        point.setAttribute(&quot;class&quot;,&quot;point&quot;);
        this.svg.appendChild(point);
        return point;
    },

    drawRect: function (x,y) {
        var svgns = &quot;http://www.w3.org/2000/svg&quot;;
        var rect = document.createElementNS(svgns,&quot;rect&quot;);
        rect.setAttribute(&quot;x&quot;,x - 2.5);
        rect.setAttribute(&quot;y&quot;,y - 2.5);
        rect.setAttribute(&quot;width&quot;,&quot;5&quot;);
        rect.setAttribute(&quot;height&quot;,&quot;5&quot;);
        rect.setAttribute(&quot;stroke&quot;,&quot;#2f8bf5&quot;);
        rect.setAttribute(&quot;fill&quot;,&quot;white&quot;);
        this.svg.appendChild(rect);
        return rect;
    },

    drawLine: function (x,y,color,first)　{
        var svgns = &quot;http://www.w3.org/2000/svg&quot;;
        var line = document.createElementNS(svgns,&quot;line&quot;);
        if (first) {
            line.setAttribute(&quot;x1&quot;,this.ofX);
            line.setAttribute(&quot;y1&quot;,this.ofY + this.distance);
        }
        else {
            line.setAttribute(&quot;x1&quot;,this.ofX + this.distance);
            line.setAttribute(&quot;y1&quot;,this.ofY);
        }

        line.setAttribute(&quot;x2&quot;,x);
        line.setAttribute(&quot;y2&quot;,y);
        line.setAttribute(&quot;stroke&quot;,color);
        line.setAttribute(&quot;fill&quot;,&quot;transparent&quot;);
        line.setAttribute(&quot;stroke-width&quot;,&quot;2&quot;);
        line.setAttribute(&quot;class&quot;,&quot;point&quot;);
        this.svg.appendChild(line);
        return line;
    },

    updateValue: function () {
        this.bezierBinding = [
            this.bezier[0].toFixed(2),
            this.bezier[1].toFixed(2),
            this.bezier[2].toFixed(2),
            this.bezier[3].toFixed(2),
        ];
    },

    selectCurvesChanged: function () {
        this.$.btnGrp.innerHTML = &#x27;&#x27;;
        for (var item in this.selectCurves) {
            var btns = document.createElement(&#x27;div&#x27;);
            btns.className = &#x27;btn_item&#x27;;
            if (item === &#x27;0&#x27; ) {
                btns.setAttribute(&#x27;active&#x27;,&#x27;&#x27;);
            }
            btns.addEventListener(&#x27;click&#x27;,function(event) {
                this.changeBezier(event);
            }.bind(this));
            btns.innerHTML = this.selectCurves[item].name;
            this.$.btnGrp.appendChild(btns);
        }
        this.$.beziers.children[this.typeIndex + 1].setAttribute(&#x27;select&#x27;,&#x27;&#x27;);
        this.bezier = this.curves[this.typeIndex].items[0].value.slice(0);
        this.drawBezier();
    },

    loadCustomBezier: function () {
        this.$.btnGrp.innerHTML = &#x27;&#x27;;
        var btns = document.createElement(&#x27;div&#x27;);
        btns.className = &#x27;btn_item&#x27;;
        btns.setAttribute(&#x27;active&#x27;,&#x27;&#x27;);
        btns.innerHTML = &#x27;Custom&#x27;;
        this.$.btnGrp.appendChild(btns);
    },

    setBezier: function (bezier) {
        this.loadCustomBezier();
        this.bezier = bezier.slice(0);
        this.drawBezier();
    },

    updateAnimate: function () {
        if (this._stopPreview) {
            this.$.animate1.style.bottom = -1;
            this.$.animate2.style.left = -1;
            this._previewProgress = 0;
            return;
        }

        window.requestAnimationFrame(function() {
            if (this._previewProgress &gt;= 1) {
                this._previewProgress = 0;
            }
            var y = Fire._bezier(this.bezier,this._previewProgress);
            this.$.animate1.style.bottom = y * this.distance;
            this.$.animate2.style.left = this._previewProgress * this.distance;
            this._previewProgress += 0.005;
            this.updateAnimate();
        }.bind(this));
    },

    playPreview: function() {
        this._stopPreview = false;
        this.updateAnimate();
    },

    stopPreview: function () {
        this._stopPreview = true;
    },

    _getRotat: function (x1,y1,x2,y2) {
        var x = Math.abs(x1-x2);
        var y = Math.abs(y1-y2);
        var z = Math.sqrt(x*x+y*y);
        var rotat = Math.round((Math.asin(y/z)/Math.PI*180));

        if (x2 &gt;= x1 &amp;&amp; y2 &lt;= y1) {
            rotat = rotat;
        }
        else if (x2 &lt;= x1 &amp;&amp; y2 &lt;= y1) {
            rotat = 180 - rotat;
        }
        else if (x2 &lt;= x1 &amp;&amp; y2 &gt;= y1) {
            rotat = 180 + rotat;
        }else if(x2 &gt;= x1 &amp;&amp; y2 &gt;= y1){
            rotat = 360 - rotat;
        }
        return rotat;
    },

    _getLineWidth: function (points,index) {
        if (index === 0) {
            return Math.sqrt(Math.pow(0 - points.x,2) + Math.pow(0 - points.y,2));
        }
        else {
            return Math.sqrt(Math.pow(points.x - 1,2) + Math.pow(points.y - 1,2));
        }
    },

    rotatLine: function (controlCoord,oldCoord,newCoord,controlIndex) {
        var r = this._getLineWidth({x : controlCoord.x , y : controlCoord.y },controlIndex) * this.distance;
        var rotat = this._getRotat(oldCoord.x,oldCoord.y,newCoord.x,newCoord.y);
        var newx = (Math.cos(Math.deg2rad(rotat)) * r) / this.distance;
        var newy = (Math.sin(Math.deg2rad(rotat)) * r) / this.distance;
        return {x: newx, y: newy};
    },

});

    </pre>
</div>
</div>
        </div>

    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/vendor/jquery.min.js"></script>
<script src="../assets/js/jquery-offscreen-trigger.js"></script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
